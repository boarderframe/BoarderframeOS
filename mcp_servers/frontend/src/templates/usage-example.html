<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Product Cards - Usage Example</title>
    <script src="./product-card-generator.js"></script>
</head>
<body style="margin: 0; padding: 20px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5;">
    
    <h1 style="text-align: center; color: #222; margin-bottom: 30px;">Grocery Product Cards - MCP Integration Example</h1>
    
    <!-- Container for dynamic product cards -->
    <div id="product-container"></div>
    
    <script>
        // Sample product data from MCP server
        const sampleProducts = [
            {
                name: "Kroger® 73/27 Ground Beef Roll",
                upc: "0001111097920",
                brand: "Kroger",
                price: 6.29,
                size: "1 lb",
                available: true,
                delivery: true
            },
            {
                name: "Simple Truth® Organic Free Range Large Brown Eggs",
                upc: "0001111082199",
                brand: "Simple Truth",
                price: 4.99,
                size: "12 ct",
                available: true,
                delivery: true
            },
            {
                name: "Kroger® 2% Reduced Fat Milk",
                upc: "0001111041700",
                brand: "Kroger",
                price: 3.49,
                size: "1 gallon",
                available: false,
                delivery: false
            },
            {
                name: "Private Selection® Sourdough Bread",
                upc: "0001111089012",
                brand: "Private Selection",
                price: 3.99,
                size: "24 oz",
                available: true,
                delivery: true
            },
            {
                name: "Kroger® Salted Butter Sticks",
                upc: "0001111084471",
                brand: "Kroger",
                price: 4.79,
                size: "1 lb",
                available: true,
                delivery: false
            },
            {
                name: "Simple Truth® Organic Baby Spinach",
                upc: "0001111091243",
                brand: "Simple Truth",
                price: 2.99,
                size: "5 oz",
                available: true,
                delivery: true
            }
        ];
        
        // Initialize MCP client mock
        window.mcpClient = {
            addToCart: async function(data) {
                console.log('MCP Add to Cart:', data);
                
                // Simulate API call to MCP server
                try {
                    const response = await fetch('/api/mcp/kroger/add-to-cart', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    }).catch(err => {
                        // Fallback for demo
                        console.log('Demo mode - cart action logged:', data);
                        return { ok: true };
                    });
                    
                    if (response.ok) {
                        console.log('Successfully added to cart');
                    }
                } catch (error) {
                    console.log('Demo mode - cart action logged:', data);
                }
            },
            
            searchProducts: async function(query) {
                console.log('MCP Search Products:', query);
                // Filter sample products based on query
                return sampleProducts.filter(p => 
                    p.name.toLowerCase().includes(query.toLowerCase()) ||
                    p.brand.toLowerCase().includes(query.toLowerCase())
                );
            }
        };
        
        // Listen for add to cart events
        window.addEventListener('mcp:addToCart', (event) => {
            console.log('Cart Event:', event.detail);
            
            // Update UI or notify user
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #10b981;
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                font-weight: 600;
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = 'Product added to cart!';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        });
        
        // Add animation styles
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // Render products
        function renderProducts(view = 'grid') {
            const container = document.getElementById('product-container');
            
            if (view === 'grid') {
                container.innerHTML = ProductCardGenerator.generateGrid(sampleProducts);
            } else if (view === 'list') {
                container.innerHTML = ProductCardGenerator.generateCompactList(sampleProducts);
            }
        }
        
        // Add view toggle buttons
        const controls = document.createElement('div');
        controls.style.cssText = 'text-align: center; margin-bottom: 20px;';
        controls.innerHTML = `
            <button onclick="renderProducts('grid')" style="
                background: #4f46e5;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 6px;
                margin: 0 5px;
                cursor: pointer;
                font-weight: 600;
            ">Grid View</button>
            <button onclick="renderProducts('list')" style="
                background: #4f46e5;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 6px;
                margin: 0 5px;
                cursor: pointer;
                font-weight: 600;
            ">List View</button>
        `;
        document.querySelector('h1').after(controls);
        
        // Initial render
        renderProducts('grid');
        
        // Simulate dynamic product loading
        console.log('Product cards loaded. MCP client ready for integration.');
    </script>
    
</body>
</html>